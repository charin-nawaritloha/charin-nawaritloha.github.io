<!DOCTYPE html>
<html>

<head>
	<title>Expense</title>
	<meta charset="utf-8">
	<meta name="author" content="Charin Nawaritloha">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		input.ui {
			font-size: 2rem;
		}

		td.expense {
			color: #E91E63;
			font-weight: bold;
			text-align: right;
		}


		table,
		th,
		td {
			border: 1px solid gray;
			border-collapse: collapse;
			vertical-align: top;
		}

		div.bin {
			cursor: pointer;
		}
	</style>
</head>

<body>
	<input type="button" value="üìë‡∏™‡∏•‡∏±‡∏ö‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" onclick="swapMode()" style="margin-bottom: 0.5rem;">
	<div id="form">
		<div>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</div>
		<div><input type="date" class="ui" id="timestamp"></div>
		<div id="buttonDiv"></div>
		<div><input type="text" id="category"></div>
		<div>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</div>
		<div><input type="text" id="detail" style="width: 95%;"></div>
		<div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</div>
		<div><input type="number" class="ui" id="expense" style="text-align: right; width: 9rem;"> ‡∏ö‡∏≤‡∏ó</div>
		<div>üõí‡∏Ñ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠</div>
		<div>
			<input type="button" class="ui" value="üôã‚Äç‚ôÇÔ∏è" onclick="selectBuyer(this)"><input type="button" class="ui" value="üôã‚Äç‚ôÄÔ∏è" onclick="selectBuyer(this)"><input type="button" class="ui" value="ü§ù" onclick="selectBuyer(this)">
			‚Üí <input type="text" class="ui" id="buyer" style="text-align: center; width: 2.5rem; border: none;">
		</div>
		<div>ü§ë‡∏Ñ‡∏ô‡∏à‡πà‡∏≤‡∏¢</div>
		<div>
			<input type="button" class="ui" value="üôã‚Äç‚ôÇÔ∏è" onclick="selectPayer(this)"><input type="button" class="ui" value="üôã‚Äç‚ôÄÔ∏è" onclick="selectPayer(this)"><input type="button" class="ui" value="ü§ù" onclick="selectPayer(this)">
			‚Üí <input type="text" class="ui" id="payer" style="text-align: center; width: 2.5rem; border: none;">
		</div>
		<div>
			<input type="button" class="ui" value="üíµ" onclick="selectPayment(this)"><input type="button" class="ui" value="üí≥" onclick="selectPayment(this)">
			‚Üí <input type="text" class="ui" id="payment" style="text-align: center; width: 2.5rem; border: none;">
		</div>
		<div><hr></div>
		<div>
			<input type="button" value="üíæ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" onclick="saveExpense()" style="font-size: 1.5rem; margin-top: 1rem;">
			<input type="button" value="üóëÔ∏è‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà" onclick="clearExpense()" style="font-size: 1.5rem; margin-top: 1rem;">
		</div>
	</div>
	<div id="data" style="display: none;">
		<input type="button" value="üíæCopy" onclick="copytable('dataTable')">
		<input type="button" value="üóëÔ∏èClear" onclick="clearData()">
		<div id="dataTable"></div>
	</div>



</body>

</html>
<script>
	var mode = 0;

	/// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö category
	function createButtons() {
		var buttons = [
			"üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
			"üç∞ ‡∏Ç‡∏ô‡∏°/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°",
			"üçâ ‡∏ú‡∏•‡πÑ‡∏°‡πâ",
			"üê∂ ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç",
			"",
			"üçÑ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏î/‡∏ú‡∏±‡∏Å/‡πÑ‡∏Ç‡πà/‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå",
			"‚õΩ ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á/‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á",
			"üõçÔ∏è Shopping",
			"",
			"üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢",
			"üì∫ ‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á",
			"üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û",
			"‚úàÔ∏è ‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß",
			"",
			"üí≥ ‡∏†‡∏≤‡∏©‡∏µ/‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô/‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
			"üì∂ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï",
			"üõ†Ô∏è ‡∏á‡∏≤‡∏ô",
			"‚ùì ‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
		];
		var topDiv = document.getElementById("buttonDiv");
		var e;
		var rowDiv = document.createElement("div");

		buttons.forEach(element => {
			if (element.length == 0) {
				topDiv.appendChild(rowDiv);
				rowDiv = document.createElement("div");
			}
			else {
				e = document.createElement("input");
				e.type = "button";
				e.className = "ui"
				var label = element.split(" ");
				e.value = label[0];
				e.title = label[1];
				e.addEventListener("click", selectCategory);
				rowDiv.appendChild(e);
			}
		});

		topDiv.appendChild(rowDiv);
	}

	function selectCategory(event) {
		var button = event.target;
		var text = document.getElementById("category");
		text.value = button.value + button.title;
	}

	function selectBuyer(button) {
		//var button = event.target;
		var text = document.getElementById("buyer");
		text.value = button.value;
	}

	function selectPayer(button) {
		//var button = event.target;
		var text = document.getElementById("payer");
		text.value = button.value;
	}

	
	function selectPayment(button) {
		//var button = event.target;
		var text = document.getElementById("payment");
		text.value = button.value;
	}

	/// ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏•‡∏á‡πÉ‡∏ô localStorage
	function saveExpense() {
		var category = document.getElementById("category");
		var detail = document.getElementById("detail");
		var expense = document.getElementById("expense");
		var buyer = document.getElementById("buyer");
		var payer = document.getElementById("payer");
		var payment = document.getElementById("payment");

		var expenseValue = Number.parseFloat(expense.value);

		if (Number.isNaN(expenseValue) || expenseValue < 1) {
			alert("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô");
			expense.focus();
			return;
		}

		if (category.value.length == 0) {
			alert("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢");
			category.focus();
			return;
		}

		if (buyer.value.length == 0) {
			buyer.value = "üôã‚Äç‚ôÇÔ∏è";
		}

		if (payer.value.length == 0) {
			payer.value = "üôã‚Äç‚ôÇÔ∏è";
		}

		if (payment.value.length == 0) {
			payment.value = "üíµ";
		}

		var inputDate = document.getElementById("timestamp").valueAsDate;
		var today = new Date(inputDate);


		var dataText = JSON.stringify({
			timestamp: String(today.getFullYear() + "/" + (today.getMonth() + 1) + "/" + today.getDate()),
			category: category.value,
			detail: detail.value,
			expense: expense.value,
			buyer: buyer.value,
			payer: payer.value,
			payment: payment.value
		});

		var key = "i" + localStorage.length;

		localStorage.setItem(key, dataText);

		alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");

		category.value = "";
		detail.value = "";
		expense.value = "";
		buyer.value = "";
		payer.value = "";
		payment.value = "";
	}

	/// ‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ
	function swapMode() {
		if (mode == 0) {
			mode = 1;
			var div = document.getElementById("dataTable");

			document.getElementById("form").style.display = "none";
			document.getElementById("data").style.display = "block";

			var output = "<table><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th>‡∏ã‡∏∑‡πâ‡∏≠</th><th>‡∏à‡πà‡∏≤‡∏¢</th><th></th></tr>"

			for (var i = localStorage.length - 1; i > -1; --i) {
				var key = "i" + i;
				var dataText = localStorage.getItem(key);
				var obj = JSON.parse(dataText);
				var row = [];
				row.push("<tr>");
				row.push("<td>" + obj.timestamp + "</td>");
				row.push("<td>" + obj.category + "</td>");
				row.push("<td>" + obj.detail + "</td>");
				row.push("<td class=\"expense\">" + obj.expense + "</td>");
				row.push("<td>" + obj.buyer + "</td>");
				row.push("<td>" + obj.payer + "</td>");
				row.push("<td>" + obj.payment + "</td>");
				//row.push("<td><input type=\"button\" value=\"‚ùå\" onclick=\"removeItem('" + key + "', '" + obj.timestamp + ' ' + obj.category + "')\"></td></tr>");
				row.push("<td><div class=\"bin\" onclick=\"removeItem('" + key + "', '" + obj.timestamp + ' ' + obj.category + "')\">‚õî</div></td></tr>");
				output = output + row.join("");
			}

			div.innerHTML = output + "</table>";
		}
		else {
			mode = 0;
			var div = document.getElementById("dataTable");
			div.innerHTML = "";
			document.getElementById("form").style.display = "block";
			document.getElementById("data").style.display = "none";
		}
	}

	/// ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏¥‡πâ‡∏á
	function clearData() {
		if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà")) {
			localStorage.clear();
			mode = 0;
			swapMode();
		}
	}

	/// ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏•‡∏á‡πÉ‡∏ô clipboard ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
	function copytable(el) {
		var urlField = document.getElementById(el);
		var range = document.createRange();
		range.selectNode(urlField);
		window.getSelection().addRange(range);
		document.execCommand('copy');
		alert("‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏•‡∏á‡πÉ‡∏ô clipboard ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
	}

	/// ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
	function removeItem(key, title) {
		if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• " + title + " ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°")) {
			var dataText = JSON.stringify({
				timestamp: "",
				category: "",
				detail: "",
				expense: 0.0,
				buyer: "",
				payer: "",
				payment: ""
			});
			localStorage.setItem(key, dataText);
			mode = 0;
			swapMode();
		}
	}

	/// ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà
	function clearExpense() {
		document.getElementById("timestamp").valueAsDate = new Date();
		document.getElementById("category").value = "";
		document.getElementById("detail").value = "";
		document.getElementById("expense").value = "";
		document.getElementById("buyer").value = "";
		document.getElementById("payer").value = "";
		document.getElementById("payment").value = "";
	}

	// init here
	createButtons();
	clearExpense();	
</script>