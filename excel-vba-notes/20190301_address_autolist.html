<!DOCTYPE html>
<html>
<head>
	<title>ตัวเลือกจังหวัด อำเภอ ตำบล แบบลูกโซ่ ไม่ใช้แมโคร</title>
	<meta name="tags" contents="Cookbook">

	<!--header-->
	<meta property="fb:app_id" content="306783623357456" />
	<meta charset="utf-8">
	<meta name="author" content="Charin Nawaritloha">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	
	<link href='css/normalize.css' rel='stylesheet' type='text/css'>
	<link href='css/skeleton.css' rel='stylesheet' type='text/css'>
	<link href='css/main.css' rel='stylesheet' type='text/css'>
	<link href='css/fonts.css' rel='stylesheet' type='text/css'>
	
	<link rel="icon" type="image/png" href="favicon.png">
	
	<link href='SyntaxHighlighter/shCore.css' rel='stylesheet' type='text/css'>
	<link href='SyntaxHighlighter/shThemeDefault.css' rel='stylesheet' type='text/css'>
	<script src='SyntaxHighlighter/shCore.js' type='text/javascript'></script>
	<script src='SyntaxHighlighter/shAutoloader.js' type='text/javascript'></script>
	<script src='SyntaxHighlighter/shBrushVb.js' type='text/javascript'></script>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
	
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({
			google_ad_client: "ca-pub-9963456691869043",
			enable_page_level_ads: true
		});
	</script>
	<!--/header-->
</head>


<body>
<!--facebook-->
<div id="fb-root"></div>
<script async defer src="https://connect.facebook.net/th_TH/sdk.js#xfbml=1&version=v3.2&appId=306783623357456&autoLogAppEvents=1"></script>
<!--/facebook-->


<div class="container">
<!--navbar-->
<div id="navbar">
	<div class="container">
		<a href="index.html">หน้าหลัก</a>
		<a href="p/bill123.html">บิล123</a>
		<a href="p/vba.html">รับเขียน VBA</a>
		<a href="p/macros.html">วิธีเปิด/ปิด แมโคร</a>
		<a href="p/km.html" class="nowrap">แหล่งอ้างอิงข้อมูล</a>
		<a href="p/portfolio.html" class="nowrap">ผลงาน</a>
		<a href="p/profiles.html" class="nowrap">ผู้เขียน</a>
	</div>
</div>
<div id="navbar_space"></div>
<!--/navbar-->




<div class="row">
<div class="twelve columns">
<h1>ตัวเลือกจังหวัด อำเภอ ตำบล แบบลูกโซ่ ไม่ใช้แมโคร (Droplist combo box/Dependent Dropdown List)</h1>
<p>น่าจะมีคนใช้บ่อย ๆ กับแบบฟอร์มที่อยู่ ที่อยากให้เลือกข้อมูล จังหวัด แล้วแสดงอำเภอเฉพาะจังหวัดที่เลือก แล้วแสดงตำบลของอำเภอที่เลือก เป็นแบบลูกโซ่ ใน Excel (Dependent Dropdown List) สามารถทำได้ครับ ไม่ยาก ผมได้ทำมาสำเร็จรูปมาให้ใช้งานแล้วครับ โดยเป็น Droplist ธรรมดา ไม่ได้ใช้แมโครหรือคำสั่งพิเศษแต่ประการใด แต่ใช้วิธีสร้าง Formula Name ตามชื่อจังหวัด จังหวัด+อำเภอ เอาไว้ล่วงหน้า แล้วใช้คำสั่ง INDIRECT ในการดึงมาใช้งานอีกที (ลองใช้คำสั่ง Data→Data Validation เพื่อดูสูตรได้)</p>

	<div class="image"><img src="images/20190301_01_address_autolist.gif" class="u-max-full-width" />
	<div>การเลือกจังหวัด อำเภอ ตำบล แบบลูกโซ่ (ตัวเลือกแบบที่อยู่แบบ Dependent Dropdown List)</div>
	</div>

	<div class="image"><img src="images/20190301_07_datavalidation.png" class="u-max-full-width" />
	<div>สูตรที่ผูกไว้กับ Data Validation ของตัวเลือกอำเภอ</div>
	</div>

	
<!--ads1-->
<div class="ads"></div>
<!--/ads1-->	
	
	
<h2>การคัดลอกไปใช้งาน</h2>
<p>ในไฟล์ <b>20190301_address_autolist.xlsx</b> จะมีชีทชื่อ Provice อยู่ ให้ทำการคัดลอกไปที่ไฟล์ที่เราต้องการจะทำแบบฟอร์ม</p>

	<div class="image"><img src="images/20190301_02_copy_province.png" class="u-max-full-width" />
	<div>Copy ชีท Province ไปไว้ในไฟล์ที่เราต้องการจะใช้งาน</div>
	</div>

<p>จากนั้นให้ทำการคัดลอกตัวเลือก จังหวัด อำเภอ ตำบล แล้วนำไปวางที่แบบฟอร์มที่เราต้องการจะใช้งาน โดยให้วางไว้ที่ว่าง ๆ เพื่อจะได้ทำการย้ายตัว Droplist ไปวางบนฟอร์มอีกที</p>

	<div class="image"><img src="images/20190301_03_copy_droplist.png" class="u-max-full-width" />
	<div>ทำการคลิกเลือกพื้นที่ จังหวัด อำเภอ ตำบล แล้ว Copy</div>
	</div>

	<div class="image"><img src="images/20190301_04_paste_droplist.png" class="u-max-full-width" />
	<div>วางในไฟล์แบบฟอร์มที่เราต้องการ ตรงไหนก็ได้ที่ว่าง ๆ โปรแกรมจะถามว่าชื่อซ้ำ ต้องการให้ใช้ชื่อในไฟล์ใหม่หรือไม่ ให้เลือก Yes</div>
	</div>


	<div class="image"><img src="images/20190301_05_move_droplist.png" class="u-max-full-width" />
	<div>ขั้นตอนสุดท้ายคือ ย้ายตัว Droplist ไปวางไปบนแบบฟอร์มที่จะใช้งานจริง</div>
	</div>
	
	<div class="image"><img src="images/20190301_06_move_droplist.gif" class="u-max-full-width" />
	<div>เมื่อย้ายเรียบร้อยแล้ว ให้ทดสอบดูว่าใช้งานได้หรือไม่</div>
	</div>

<h2>ดาวน์โหลดไฟล์</h2>
<p>หากสนใจจะใช้งาน สามารถดาวน์โหลดไฟล์ไปใช้งานได้เลย</p>
<p><a href="https://github.com/charin-nawaritloha/excel-vba-notes-samples/raw/master/20190301_address_autolist/20190301_address_autolist.xlsx" target="ext_link">คลิกเพื่อดาวน์โหลดจาก GitHub</a></p>

	<div class="image"><img src="images/20190301_06_download.png" class="u-max-full-width" />
	<div>คลิกที่ปุ่มดาวน์โหลดมุมบนขวา</div>
	</div>

<h2>การปรับปรุงข้อมูล</h2>	
<p>เนื่องจากข้อมูล จังหวัด อำเภอ ตำบล ผมเอามาจากเว็บไซต์หน่วยงานรัฐ ซึ่งไม่แน่ใจว่าถูกต้อง 100% หรือไม่ หากพบว่ามีข้อผิดพลาด รบกวนช่วยแจ้งไว้ใน Comment อีเมลมาแจ้ง หรือจะ<a href="https://github.com/charin-nawaritloha/excel-vba-notes-samples/issues" target="ext_link">เปิด Issue ใน GitHub</a> ก็ได้ครับ เพื่อผมจะได้ปรับปรุงข้อมูลให้ถูกต้องต่อไป ขอบคุณครับ</p>
	
	
<h2>ชื่อ List ที่อ้างในสูตรสร้างมาจากไหน</h2>	
<p>หากใครแกะสูตรดู จะพบว่า ชื่อที่อ้างในสูตร INDIRECT ไม่พบใน Name Manager เลยสงสัยว่ามันอ้างอย่างไร ต้องอธิบายอย่างนี้ครับ ในการสร้าง List สำหรับใช้เลือก อำเภอ และ ตำบล ผู้เขียนใช้วิธีเขียนโปรแกรม VBA ขึ้นมาเพื่อทำการสร้างชื่อให้อัตโนมัติตามตารางในชีท Province เช่น หากเลือกจังหวัดเป็น กรุงเทพมหานคร ใช่ช่องเลือกอำเภอ จากสูตร จากสูตร =INDIRECT("a_" & C7) เมื่อแทน C7 ผลที่ได้คือ =INDIRECT("a_กรุงเทพมหานคร") ซึ่งชื่อ "a_กรุงเทพมหานคร" ถูกสร้างด้วย VBA และซ่อนเอาไว้</p>
<p>แล้วไมผมต้องซ่อนชื่อของ List ที่สร้างขึ้นมา ที่ต้องทำแบบนี้เพราะ หากแสดงชื่อ List ทั้งหมด จะรบกวนการใช้งานปกติทันที เพราะจำนวน List จะเยอะมาก (จำนวนจังหวัด + จำนวนอำเภอ = 77 + 928 = 1,005 ชื่อ) จึงเป็นเหตุผลที่ต้องซ่อนเอาไว้ครับ</p>
<p>หากใครอยากได้ทำแบบนี้ใช้เองโดยไม่ต้องใช้ VBA ในอินเทอร์เน็ตมีคนสอนอยู่แล้วครับ สามารถ Google หาดูได้ ของผู้เขียนเน้นเอาไปใช้งานได้เลยมากกว่าที่จะเน้นให้มาแกะสูตรสร้างใช้เองครับ</p>
	
<!--ads2-->
<div class="ads"></div>
<!--/ads2-->


</div></div>




<!--comments-->
<div class="container">
	<div class="fb-like" data-share="true" data-show-faces="true" />
	<div style="padding-top:10rem;">&nbsp;</div>
	<div class="fb-comments" data-numposts="10" data-width="100%"></div>
</div>
<!--/comments-->








<!--counter-->
<div class="row" style="padding-top:3rem;">
<div class="five columns">&nbsp;</div>
<div class="two columns">
	<div id="histats_counter"></div>
	<!-- Histats.com  START -->
	<script type="text/javascript">var _Hasync= _Hasync|| [];
	_Hasync.push(['Histats.start', '1,4227101,4,227,112,50,00011010']);
	_Hasync.push(['Histats.fasi', '1']);
	_Hasync.push(['Histats.track_hits', '']);
	(function() {
	var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
	hs.src = ('//s10.histats.com/js15_as.js');
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
	})();</script>
	<noscript><a href="/" target="_blank"><img  src="//sstatic1.histats.com/0.gif?4227101&101" alt="" border="0"></a></noscript>
	<!-- Histats.com  END -->
</div>
<div class="five columns">&nbsp;</div>	
</div>
<!--/counter-->









<!--footer-->

<!--/footer-->
</div>
</body>
</html>