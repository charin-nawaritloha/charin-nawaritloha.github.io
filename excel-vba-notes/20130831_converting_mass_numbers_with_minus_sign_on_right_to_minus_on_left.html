<!DOCTYPE html>
<html>
<head>
	<title>การแปลงตัวเลขที่ติดลบ แต่เครื่องหมายลบอยู่ด้านหลัง ครั้งละมาก ๆ ใน Excel (Converting mass Numbers with Minus Sign on Right to Minus on Left)</title>
	<meta name="tags" contents="Excel">

	<!--header-->
	<meta property="fb:app_id" content="306783623357456" />
	<meta charset="utf-8">
	<meta name="author" content="Charin Nawaritloha">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<link href='css/normalize.css' rel='stylesheet' type='text/css'>
	<link href='css/skeleton.css' rel='stylesheet' type='text/css'>
	<link href='css/main.css' rel='stylesheet' type='text/css'>
	<link href='css/fonts.css' rel='stylesheet' type='text/css'>
	
	<link rel="icon" type="image/png" href="favicon.png">
	
	<link href='SyntaxHighlighter/shCore.css' rel='stylesheet' type='text/css'>
	<link href='SyntaxHighlighter/shThemeDefault.css' rel='stylesheet' type='text/css'>
	<script src='SyntaxHighlighter/shCore.js' type='text/javascript'></script>
	<script src='SyntaxHighlighter/shAutoloader.js' type='text/javascript'></script>
	<script src='SyntaxHighlighter/shBrushVb.js' type='text/javascript'></script>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
	
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({
			google_ad_client: "ca-pub-9963456691869043",
			enable_page_level_ads: true
		});
	</script>
	<!--/header-->
</head>


<body>
<!--facebook-->
<div id="fb-root"></div>
<script async defer src="https://connect.facebook.net/th_TH/sdk.js#xfbml=1&version=v3.2&appId=306783623357456&autoLogAppEvents=1"></script>
<!--/facebook-->


<div class="container">
<!--navbar-->
<div id="navbar">
	<div class="container">
		<a href="index.html">หน้าหลัก</a>
		<a href="p/bill123.html">บิล123</a>
		<!-- <a href="p/vba.html">รับเขียน VBA</a> -->
		<a href="p/macros.html">วิธีเปิด/ปิด แมโคร</a>
		<a href="p/km.html" class="nowrap">แหล่งอ้างอิงข้อมูล</a>
		<a href="p/portfolio.html" class="nowrap">ผลงาน</a>
		<a href="p/profiles.html" class="nowrap">ผู้เขียน</a>
	</div>
</div>
<div id="navbar_space"></div>
<!--/navbar-->




<div class="row">
<div class="twelve columns">
<h1>การแปลงตัวเลขที่ติดลบ แต่เครื่องหมายลบอยู่ด้านหลัง ครั้งละมาก ๆ ใน Excel (Converting mass Numbers with Minus Sign on Right to Minus on Left)</h1>
<p>ช่วงเดือนที่ผ่านมางานยุ่งมาก ๆ กับการที่ต้องใช้ Excel แก้ไขปัญหากับงานที่ทำอยู่ครับ เลยไม่ค่อยได้เขียนอะไรใหม่ แต่ดันเจอประเด็นที่คิดว่าน่าจะนำมาเขียนไว้จนได้ นั้นคือในกรณีที่เรามีข้อมูลที่เป็นตัวเลขติดลบ แต่เครื่องหมายลบดันไปอยู่ด้านหลัง ทำให้ Excel ตีความเป็นข้อความ ซึ่งปัญหานี้จะทำให้ไม่สามารถใช้คำสั่งในการคำนวณใด ๆ ได้เลย</p>

	<div class="image"><img src="images/20130831_01-excel01.png" class="u-max-full-width" />
	<div>เมื่อเลือกข้อมูลผลที่ได้คือ Sum:0 ที่ควรจะเป็นคือ Sum: -86391.98</div>
	</div>

<p>จากที่ลองหาวิธีแก้ไขในกรณีนี้ (ด้วย google) พบว่าส่วนใหญ่จะใช้อยู่ 2 วิธีคือ</p>
<ol>
<li>ใช้สูตรช่วยในการแก้ไขข้อมูล</li>
<li>เขียน VBA macro</li>
</ol>

<p>(อ้างอิงวิธีการแก้ไขจาก Microsoft:&nbsp;<a href="http://support.microsoft.com/kb/42964">http://support.microsoft.com/kb/42964</a>)</p>
	
<p>ซึ่งทั้งสองวิธีนี้สอบตกสำหรับผมเพราะ ข้อมูลในรายงานเยอะมาก เป็นพัน ๆ ช่อง และผู้ใช้ (ผู้ใช้อย่างเดียวจริง ๆ) ไม่สะดวกที่จะใช้ VBA ดั้งนั้นวิธีการที่ผมหามาคือ การใช้วิธีการแปลงข้อความมาเป็นตัวเลขที่เป็นความสามารถของ Excel ที่มีอยู่แล้ว ไม่ได้ใช้วิธีพิเศษอะไรเพิ่มเติม</p>

<p>วิธีที่ใช้มีสองวิธี วิธีแรกคือบันทึกเป็น Text แล้วเปิดไฟล์ Text โปรแกรม Excel จะช่วยแปลง 123- เป็นค่า -123 ในตอนที่นำเข้าข้อมูลให้อัตโนมัติ ลองแล้วเยี่ยมมาก ๆ </p>

<p>ในกรณีที่ข้อมูลไม่มาก ไม่อยากใช้สูตร หรือ VBA ก็ใช้คำสั่ง Text to columns คำสั่งเดียวจบครับ</p>


<!--ads1-->
<div class="ads"></div>
<!--/ads1-->

<h2>วิธีการแปลงข้อมูลด้วย Text file</h2>
<ol>
<li>ทำการ Save As เป็น Text file เป็นชื่อใหม่</li>
<li>ทำการเปิด Text file ที่ Save ด้วย Excel อีกครั้ง</li>
<li>ในขั้นตอนการนำเข้าข้อมูล ให้แนใจว่าเลือก Tab เป็นตัวแบ่งข้อมูลในขั้นตอนที่ 2 จาก 3 (ในการใช้งานจริงกดปุ่ม Finish เลยก็ได้ ถ้าข้อมูลแสดงไม่ถูกต้องค่อยไล่ที่ละขั้นตอน</li>
<li>ตรวจสอบว่าตัวเลขติดลบค่าถูกต้องหรือไม่</li>
<li>ถ้าถูกต้องแล้วทำการ copy ข้อมูลทั้งแผ่นงาน แล้วไป Paste by Values ในไฟล์ต้นฉบับ</li>
</ol>

	<div class="image"><img src="images/20130831_02-excel02.png" class="u-max-full-width" />
	<div>ทำการ Save as เป็น Text (Tab delmited) โดยเปลี่ยนชื่อไฟล์ใหม่ด้วย กันพลาด</div>
	</div>

	<div class="image"><img src="images/20130831_03-excel03.png" class="u-max-full-width" />
	<div>คำเตือน ให้กด Yes เลย</div>
	</div>
	
	<div class="image"><img src="images/20130831_04-excel04.png" class="u-max-full-width" />
	<div>ใช้คำสั่ง Open เพื่อเปิด Text file ที่บันทึกไว้ในตอนแรก</div>
	</div>	
	
	
	<div class="image"><img src="images/20130831_05-excel05.png" class="u-max-full-width" />
	<div>ในขั้นตอนการ Import ข้อมูล สามารถกด Finish ได้เลย</div>
	</div>
	
	<div class="image"><img src="images/20130831_06-excel06.png" class="u-max-full-width" />
	<div>ในกรณีที่กด Finish แล้วข้อมูลไม่ถูกต้อง ให้ปิดแล้วลองเปิดไฟล์ใหม่ กด Next → ตรวจสอบว่า Step 2 of 3 ใน Delimiters เป็น Tab หรือไม่ (ตัวแบ่งคอลัมน์)</div>
	</div>	

	<div class="image"><img src="images/20130831_07-excel08.png" class="u-max-full-width" />
	<div>ตรวจสอบความถูกต้องจะเห็นว่า 86391.98- ในตอนแรก ตอนนี้เป็นค่าตัวเลขติดลบไปคำนวณได้แล้ว</div>
	</div>	

	
<h2>การแปลงโดยใช้คำสั่ง Text to columns</h2>

<p>หากลองใช้คำสั่งนี้บ่อย ๆ จะพบว่ามันมีประโยชน์นอกจากช่วยแปลงวันที่แล้ว ยังช่วยแปลงเลขติดลบที่ตัวเครื่องลบอยู่ด้านหลังได้ด้วย วิธีนี้เหมาะกับข้อมูลไม่เยอะครับ เพราะทำได้ทีละคอลัมน์เท่านั้น (วิธีนี้ยังพออยู่บ้างใน google แต่ปัญหาคือ มันทำได้ทีละคอลัมน์นี่แหละ เลยใช้งานลำบาก)</p>

	<div class="image"><img src="images/20130831_08-convert text to columns1.png" class="u-max-full-width" />
	<div>เลือกข้อมูลที่ต้องการจะแปลง เลือกคำสั่ง Data → Text to Columns</div>
	</div>	
	
	<div class="image"><img src="images/20130831_09-convert text to columns2.png" class="u-max-full-width" />
	<div>กดปุ่ม Finish ได้เลย</div>
	</div>	
	
	<div class="image"><img src="images/20130831_10-convert text to columns3.png" class="u-max-full-width" />
	<div>จะเห็นว่าเลขติดลบสามารถนำมาคำนวณได้แล้ว</div>
	</div>	
	
<!--ads2-->
<div class="ads"></div>
<!--/ads2-->	
	


</div></div>







<!--comments-->
<div class="container">
	<div class="fb-like" data-share="true" data-show-faces="true" />
	<div style="padding-top:10rem;">&nbsp;</div>
	<div class="fb-comments" data-numposts="10" data-width="100%"></div>
</div>
<!--/comments-->



<!--counter-->
<div class="row" style="padding-top:3rem;">
<div class="five columns">&nbsp;</div>
<div class="two columns">
	<div id="histats_counter"></div>
	<!-- Histats.com  START -->
	<script type="text/javascript">var _Hasync= _Hasync|| [];
	_Hasync.push(['Histats.start', '1,4227101,4,227,112,50,00011010']);
	_Hasync.push(['Histats.fasi', '1']);
	_Hasync.push(['Histats.track_hits', '']);
	(function() {
	var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
	hs.src = ('//s10.histats.com/js15_as.js');
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
	})();</script>
	<noscript><a href="/" target="_blank"><img  src="//sstatic1.histats.com/0.gif?4227101&101" alt="" border="0"></a></noscript>
	<!-- Histats.com  END -->
</div>
<div class="five columns">&nbsp;</div>	
</div>
<!--/counter-->




<!--footer-->

<!--/footer-->
</div>
</body>
</html>